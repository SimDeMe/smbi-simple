<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enzym Syntese Simulator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* --- GRUNDLÆGGENDE DESIGN --- */
        body { font-family: 'Segoe UI', sans-serif; background: #f9fbfd; text-align: center; padding: 20px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.1); }
        h2 { color: #1b5e20; margin-bottom: 25px; } /* Mørkegrøn titel */

        /* --- VISUEL BOKS --- */
        .visual-box {
            height: 260px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            background: linear-gradient(to bottom, #ffffff, #e8f5e9); /* Svag grøn gradient baggrund */
            border-radius: 12px;
            border: 1px solid #c8e6c9;
            position: relative;
            overflow: hidden;
        }

        /* --- SVG ELEMENTER --- */
        #reaction-svg {
            width: 320px;
            height: 240px;
            overflow: visible;
        }

        /* Enzymet (Den grønne form) */
        .enzyme-body {
            fill: url(#gradGreen); /* 3D effekt */
            stroke: #1b5e20;
            stroke-width: 2px;
            filter: drop-shadow(0px 4px 4px rgba(0,0,0,0.3));
            transition: all 0.8s ease;
            transform-origin: center center;
        }

        /* Substrater (Gul og Rød) */
        .sub-yellow { fill: url(#gradYellow); stroke: #fbc02d; stroke-width: 1px; }
        .sub-red { fill: url(#gradRed); stroke: #d32f2f; stroke-width: 1px; }
        
        /* Produkt (Orange) */
        .prod-orange { fill: url(#gradOrange); stroke: #f57c00; stroke-width: 1px; opacity: 0; }

        /* --- ANIMATIONER --- */

        /* 1. LAV TEMP: Svæver tilfældigt rundt */
        @keyframes float-aimless {
            0%, 100% { transform: translate(0, -60px) rotate(10deg); }
            50% { transform: translate(-20px, -70px) rotate(-5deg); }
        }
        @keyframes float-aimless-2 {
            0%, 100% { transform: translate(0, -60px) rotate(-10deg); }
            50% { transform: translate(20px, -50px) rotate(5deg); }
        }

        /* 2. OPTIMUM: Syntese Processen (Ind -> Smelt -> Ud) */
        /* Animation for de to små (Input) */
        @keyframes inputs-enter {
            0% { transform: translate(0, -100px) scale(1); opacity: 1; }
            40% { transform: translate(0, 0) scale(1); opacity: 1; } /* Lander i enzymet */
            45% { transform: translate(0, 0) scale(0.9); opacity: 1; } /* Presser sammen */
            50% { transform: translate(0, 0) scale(0.1); opacity: 0; } /* Forsvinder (bliver til produkt) */
            100% { transform: translate(0, 0) scale(0); opacity: 0; }
        }

        /* Animation for den store (Produkt) */
        @keyframes product-exit {
            0%, 45% { transform: translate(0, 0) scale(0.1); opacity: 0; }
            50% { transform: translate(0, 0) scale(1); opacity: 1; } /* Popper frem */
            60% { transform: translate(0, -10px) scale(1.1); opacity: 1; } /* Puls */
            100% { transform: translate(0, -120px) rotate(360deg); opacity: 1; } /* Flyver væk */
        }

        /* 3. DENATURERET: Enzymet ødelægges */
        .enzyme-denatured {
            /* Flader ud og bliver skæv */
            transform: scaleY(0.4) scaleX(1.2) rotate(5deg);
            fill: #78909c !important; /* Bliver grå */
        }
        @keyframes bounce-off {
            0% { transform: translate(0, -100px); }
            50% { transform: translate(10px, -40px); } /* Rammer det ødelagte enzym */
            100% { transform: translate(-50px, -120px) rotate(-45deg); } /* Bouncer væk */
        }

        /* --- TILSTANDSSTYRING (CSS Klasser) --- */
        
        /* State: Low */
        .state-low #group-yellow { animation: float-aimless 6s infinite ease-in-out; }
        .state-low #group-red { animation: float-aimless-2 5s infinite ease-in-out; }
        
        /* State: Optimum */
        .state-optimum #group-inputs { animation: inputs-enter 2s infinite cubic-bezier(0.4, 0, 0.2, 1); }
        .state-optimum #group-product { animation: product-exit 2s infinite cubic-bezier(0.4, 0, 0.2, 1); }
        
        /* State: Denatured */
        .state-denatured .enzyme-body { 
            /* Triggered via class above */
        }
        .state-denatured #group-inputs {
            animation: bounce-off 1.5s infinite linear;
        }

        /* UI */
        .status-panel { margin-top: -10px; margin-bottom: 20px; padding: 15px; border-radius: 8px; font-weight: bold; color: #1b5e20; }
        .slider-container { margin: 20px 0; }
        input[type=range] { width: 80%; accent-color: #2e7d32; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <h2>Enzym Syntese: Opbygning af Molekyler</h2>
    
    <div class="visual-box" id="visual-container">
        <svg id="reaction-svg" viewBox="0 0 200 150" xmlns="http://www.w3.org/2000/svg">
            
            <defs>
                <radialGradient id="gradGreen" cx="30%" cy="30%" r="70%">
                    <stop offset="0%" style="stop-color:#66bb6a;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#1b5e20;stop-opacity:1" />
                </radialGradient>
                <radialGradient id="gradYellow" cx="30%" cy="30%" r="70%">
                    <stop offset="0%" style="stop-color:#fff59d;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#fbc02d;stop-opacity:1" />
                </radialGradient>
                <radialGradient id="gradRed" cx="30%" cy="30%" r="70%">
                    <stop offset="0%" style="stop-color:#ef9a9a;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#c62828;stop-opacity:1" />
                </radialGradient>
                <radialGradient id="gradOrange" cx="30%" cy="30%" r="70%">
                    <stop offset="0%" style="stop-color:#ffcc80;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#e65100;stop-opacity:1" />
                </radialGradient>
            </defs>

            <g transform="translate(100, 110)">
                <path id="enzyme-shape" class="enzyme-body" d="M -60,-20 
                         C -60,40 60,40 60,-20 
                         C 50,-20 50,10 30,10 
                         C 20,10 10,-10 0,-10 
                         C -10,-10 -20,10 -30,10 
                         C -50,10 -50,-20 -60,-20 Z" />
            </g>

            <g id="group-inputs">
                <g id="group-yellow" transform="translate(70, 105)">
                    <circle class="sub-yellow" cx="0" cy="0" r="18" />
                </g>
                <g id="group-red" transform="translate(130, 105)">
                    <path class="sub-red" d="M -15,-10 Q 0,-25 15,-10 Q 20,0 15,15 Q 0,25 -15,15 Q -20,0 -15,-10" />
                </g>
            </g>

            <g id="group-product" transform="translate(100, 105)">
                <path class="prod-orange" d="M -25,0 Q -25,-20 0,-20 Q 25,-20 25,0 Q 25,20 0,20 Q -25,20 -25,0 Z" transform="scale(1.5, 1)"/>
            </g>

        </svg>
    </div>

    <div id="status-text" class="status-panel" style="background-color: #e8f5e9;">
        Temp: 0°C - Lav Energi
    </div>

    <canvas id="enzymeChart" width="400" height="200"></canvas>

    <div class="slider-container">
        <label for="tempSlider">Temperatur: <span id="tempValue">0</span>°C</label><br>
        <input type="range" id="tempSlider" min="0" max="80" value="0" step="1">
    </div>
</div>

<script>
    // --- 1. MATEMATISK MODEL ---
    function calculateRate(temp) {
        if (temp > 60) return 0;
        let activation = Math.pow(temp, 2) / 30; 
        let denaturation = 1;
        if (temp > 40) {
            denaturation = 1 - (Math.pow((temp - 40), 1.8) / 100); 
        }
        return Math.max(0, activation * denaturation);
    }

    // --- 2. GRAF OPSÆTNING ---
    const ctx = document.getElementById('enzymeChart').getContext('2d');
    const labels = Array.from({length: 81}, (_, i) => i);
    const dataPoints = labels.map(t => calculateRate(t));

    const chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Reaktionshastighed',
                data: dataPoints,
                borderColor: '#2e7d32', // Grøn graf
                backgroundColor: 'rgba(76, 175, 80, 0.1)',
                borderWidth: 3,
                fill: true,
                pointRadius: 0,
                tension: 0.4
            }, {
                data: Array(81).fill(null), // Den røde prik
                pointBackgroundColor: '#ff9800',
                pointBorderColor: '#fff',
                pointRadius: 8,
                showLine: false
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: {
                x: { title: { display: true, text: 'Temperatur (°C)' }, grid: {display: false} },
                y: { title: { display: true, text: 'Syntese-hastighed' }, min: 0, ticks: {display: false} }
            },
            animation: { duration: 0 }
        }
    });

    // --- 3. VISUEL STYRING ---
    const slider = document.getElementById('tempSlider');
    const tempValDisplay = document.getElementById('tempValue');
    const statusText = document.getElementById('status-text');
    const visualContainer = document.getElementById('visual-container');
    const enzymeShape = document.getElementById('enzyme-shape');

    function updateSimulation() {
        let t = parseInt(slider.value);
        let rate = calculateRate(t);

        tempValDisplay.innerText = t;

        // Graf
        let pointData = Array(81).fill(null);
        pointData[t] = rate;
        chart.data.datasets[1].data = pointData;
        chart.update();

        // Grafik
        updateVisuals(t);
    }

    function updateVisuals(t) {
        visualContainer.classList.remove('state-low', 'state-optimum', 'state-denatured');
        enzymeShape.classList.remove('enzyme-denatured');

        let desc = "";
        let bgColor = "";

        if (t < 15) {
            visualContainer.classList.add('state-low');
            desc = "LAV TEMPERATUR: Substraterne bevæger sig for langsomt til at møde enzymet.";
            bgColor = "#e8f5e9"; 
        } 
        else if (t >= 15 && t <= 35) {
            visualContainer.classList.add('state-low'); 
            // Her ville animationen i princippet være hurtigere, men vi bruger low-state animation
            desc = "STIGENDE TEMPERATUR: Substraterne (Gul og Rød) nærmer sig enzymet oftere.";
            bgColor = "#fff9c4"; // Gul
        }
        else if (t > 35 && t <= 45) {
            visualContainer.classList.add('state-optimum');
            desc = "OPTIMUM: Substraterne bindes i enzymet og samles til et nyt produkt (Orange).";
            bgColor = "#c8e6c9"; // Grøn
        }
        else if (t > 45) {
            visualContainer.classList.add('state-denatured');
            enzymeShape.classList.add('enzyme-denatured');
            desc = "DENATURERING: Enzymet mister sin form. Substraterne kan ikke længere binde.";
            bgColor = "#ffccbc"; // Rød
        }
        
        statusText.innerText = desc;
        statusText.style.backgroundColor = bgColor;
    }

    slider.addEventListener('input', updateSimulation);
    updateSimulation(); // Start
</script>

</body>
</html>